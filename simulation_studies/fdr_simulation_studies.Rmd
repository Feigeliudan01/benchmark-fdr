---
title: "Benchmarking FDR Methods"
author: "Rafalab Journal Club Members"
date: "`r Sys.Date()`"
output: 
    html_document:
        toc: true
        toc_float: true
        highlight: tango
        number_sections: true
        code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The goal of this working group is to benchmark recent covariate-adjusted FDR methods. For 
complete details, check out our [benchmark-fdr GitHub repo](https://github.com/pkimes/benchmark-fdr). 

In this R Markdown, we use a Monte Carlo simulation study  to evaluate different simulation scenarios: 

1. The `All nulls` simulation: All tests are simulated from the null distribution (no difference). 
2. add here... 
3. add here...
4. etc

In all cases, we define 

* $m$ = number of tests
* $M$ = Monte Carlo replications
* 

```{r}
m = 20000 # number of tests
M = 1000 # number of MC reps
```


**Things to do**: add a summary of all the simulation studies we plan to do. 

## Methods to evaluate

- IHW
- ASH
- BL
- Scott
- locfdr
- mixfdr



**Things to do**: add details, links, etc of methods here

## Metrics to evaluate

- Number of discoveries
- Control FDR at $\alpha$
- Power
- Relationship between $pi_0$ and covariate
- Assumptions: unimodal, etc

**Things to do**: Better describe metrics to evaluate our simulation studies



# The `All nulls` simulation

Simulate two standard normals with mean 0, sd = 1. Calculate t-statistic. 
Independent covariate: Uniform between 0, 1. Apply different methods. 

## Control for FDR at $\alpha$ 

Evaluate methods control for FDR at nominal $\alpha$ level ranging from [0.01, 0.1].


```{r}
# notes: convert this into R code
# - IHW: p-values from t-test, independent covariate
# - ASH: difference in means, independent covariate
# - BL: p-values from t-test, multiple covariates (with and without cov structure)
#   - lambda: 0.75, 0.85, 0.95
# - Scott: t-test statistic, independent covariate
#   - assumption of test statistic follow a standard normal. this is good here. 
# - BH: p-values only. 
# - locfdr: zz = t-test statistic, nulltype (try both). 
# - mixfdr: ? do we want to include? 

```

## add here...  